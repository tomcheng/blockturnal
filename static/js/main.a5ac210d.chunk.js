(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{194:function(e,n,t){},196:function(e,n,t){},198:function(e,n,t){"use strict";t.r(n);var r=t(3),i=t(0),o=new i.k({color:7909086}),a=new i.k({color:7909086,transparent:!0,opacity:.4}),s=new i.k({color:16711680}),c=[new i.r(0,0,0),new i.r(0,0,1),new i.r(0,1,0),new i.r(0,1,1),new i.r(1,0,0),new i.r(1,0,1),new i.r(1,1,0),new i.r(1,1,1)],u=function e(){var n=this;Object(r.a)(this,e),this.getCamera=function(){return n.camera},this.setOffset=function(e){n.offset=e},this.setDistance=function(e){n.distance=e},this.togglePosition=function(){n.side="left"===n.side?"right":"left"},this.update=function(){var e="landscape"===n.orientation?"left"===n.side?-n.offset:n.offset:0,t="landscape"===n.orientation?.5*n.offset:n.offset;n.camera.translateZ(.3*(n.distance-n.camera.position.z)),n.camera.translateX(.3*(e-n.camera.position.x)),n.camera.translateY(.3*(t-n.camera.position.y))},this.setSize=function(e,t){n.camera.aspect=e/t,n.camera.updateProjectionMatrix(),n.orientation=t>e?"portrait":"landscape","portrait"===n.orientation?n.camera.setViewOffset(e,t,0,.2*t,e,t):n.camera.setViewOffset(e,t,0,0,e,t)},this.side="left",this.orientation=null,this.distance=500,this.camera=new i.m(75,1,1,1e4+this.distance+10),this.camera.lookAt(new i.r(0,0,-1e4))},l=t(23),f=t.n(l),h=.5*Math.PI,d=new i.i,m=new i.n,w=new i.n,g=new i.n,p=new i.n,y=new i.n,x=new i.n;m.setFromRotationMatrix(d.makeRotationY(-h)),w.setFromRotationMatrix(d.makeRotationY(h)),g.setFromRotationMatrix(d.makeRotationX(-h)),p.setFromRotationMatrix(d.makeRotationX(h)),y.setFromRotationMatrix(d.makeRotationZ(h)),x.setFromRotationMatrix(d.makeRotationZ(-h));var v=t(68),k=t.n(v),z=t(69),b=t.n(z),q=t(5),E=t.n(q),F=t(70),M=t.n(F),R={x:function(e){return new i.q(e.y,e.z)},y:function(e){return new i.q(e.x,e.z)},z:function(e){return new i.q(e.x,e.y)}},C=function(e){var n=e.axis,t=e.coordinates;return k()(t.map(R[n]),b.a)},S=function(e){var n,t,r=["x","y","z"][E()(0,2)],o=1===E()(0,1),a=[0,90,180,270][E()(0,3)];return(t=a,function(e){switch(t){case 90:return e.map(function(e){return new i.q(-e.y,e.x)});case 180:return e.map(function(e){return new i.q(-e.x,-e.y)});case 270:return e.map(function(e){return new i.q(e.y,-e.x)});default:return e}})((n=o,function(e){return n?e.map(function(e){return new i.q(-e.x,e.y)}):e})(C({axis:r,coordinates:e})))},P=function(e){var n=null,t=null;return e.forEach(function(e){(null===n||e.x<n)&&(n=e.x),(null===t||e.y<t)&&(t=e.y)}),M()(e.map(function(e){return new i.q(e.x-n,e.y-t)}),["x","y"])},A=t(71),D=t.n(A),I={x:0,y:1,z:2},j=function(e){var n=e.coordinates,t=e.axis,r=e.direction,o=e.column,a=["x","y","z"].filter(function(e){return e!==t}),s=n.filter(function(e){return e[a[0]]===o.x&&e[a[1]]===o.y}).map(function(e){return e[t]}),c=new i.r;c.setComponent(I[t],"positive"===r?f()(s)+1:D()(s)-1),c.setComponent(I[a[0]],o.x),c.setComponent(I[a[1]],o.y),n.push(c)},T=new i.b(60,60,60),B=new i.h,G=new i.n,O=[].concat(c),N=[],L=function e(){var n=this;Object(r.a)(this,e),this.rotate=function(e){!function(e,n){switch(e){case"left":n.premultiply(m);break;case"right":n.premultiply(w);break;case"up":n.premultiply(g);break;case"down":n.premultiply(p);break;case"counter-clockwise":n.premultiply(y);break;case"clockwise":n.premultiply(x)}}(e,G)},this.getCurrentProjection=function(){var e=O.map(function(e){return e.clone().applyQuaternion(G).round()});return C({axis:"z",coordinates:e})},this.getRandomProjection=function(){return S(O)},this.addBlocks=function(){!function(e){var n=["x","y","z"][E()(0,2)],t=["positive","negative"][E()(0,1)],r=C({axis:n,coordinates:e}),i=r[E()(0,r.length-1)];j({coordinates:e,axis:n,direction:t,column:i})}(O),n._generateCubesAndMesh()},this.turnRed=function(){N.forEach(function(e){e.material=s})},this.reset=function(){O=[].concat(c),n._generateCubesAndMesh()},this.update=function(){i.n.slerp(B.quaternion,G,B.quaternion,.4)},this._generateCubesAndMesh=function(){N.forEach(function(e){B.remove(e)});var e=function(e){var n=null,t=null,r=null,i=null,o=null,a=null;return e.forEach(function(e){(null===n||e.x<n)&&(n=e.x),(null===r||e.y<r)&&(r=e.y),(null===o||e.z<o)&&(o=e.z),(null===t||e.x>t)&&(t=e.x),(null===i||e.y>i)&&(i=e.y),(null===a||e.z>a)&&(a=e.z)}),{width:60*(t-n+1),height:60*(i-r+1),depth:60*(a-o+1),x:60*n-30,y:60*r-30,z:60*o-30}}(O),t=e.width,r=e.height,a=e.depth,s=e.x,c=e.y,u=e.z;(N=O.map(function(e){var n=new i.j(T,o);return n.position.set(60*e.x,60*e.y,60*e.z),n.translateX(-.5*t-s),n.translateY(-.5*r-c),n.translateZ(-.5*a-u),n})).forEach(function(e){B.add(e)}),n.maxDimension=f()([t,r,a])},G.setFromEuler(new i.e(0,0,0)),this._generateCubesAndMesh(),this.mesh=B},H=function(e){var n=[],t=function(n){return e.some(function(e){return e.x===n.x&&e.y===n.y})},r=function(){switch(f){case"right":return new i.q(l.x+1,l.y-1);case"up":return new i.q(l.x+1,l.y+1);case"left":return new i.q(l.x-1,l.y+1);case"down":return new i.q(l.x-1,l.y-1)}},o=function(){switch(f){case"right":return new i.q(l.x+1,l.y);case"up":return new i.q(l.x,l.y+1);case"left":return new i.q(l.x-1,l.y);case"down":return new i.q(l.x,l.y-1)}},a=function(){switch(f){case"right":n.push(new i.q(60*(l.x+1),60*l.y)),l=r(),f="down";break;case"up":n.push(new i.q(60*(l.x+1),60*(l.y+1))),l=r(),f="right";break;case"left":n.push(new i.q(60*l.x,60*(l.y+1))),l=r(),f="up";break;case"down":n.push(new i.q(60*l.x,60*l.y)),l=r(),f="left"}},s=function(){switch(f){case"right":case"up":case"left":case"down":l=o()}},c=function(){switch(f){case"right":n.push(new i.q(60*(l.x+1),60*l.y)),f="up";break;case"up":n.push(new i.q(60*(l.x+1),60*(l.y+1))),f="left";break;case"left":n.push(new i.q(60*l.x,60*(l.y+1))),f="down";break;case"down":n.push(new i.q(60*l.x,60*l.y)),f="right"}},u=function(){var n=null;return e.forEach(function(e){n?e.y<n.y?n=e:e.y===n.y&&e.x<n.x&&(n=e):n=e}),n}(),l=u,f="right";n.push(new i.q(60*u.x,60*u.y));do{t(r())?a():t(o())?s():c()}while(l.x!==u.x||l.y!==u.y||"down"!==f);return function(e){var n=null,t=null,r=null,o=null;e.forEach(function(e){(null===n||e.x<n)&&(n=e.x),(null===r||e.y<r)&&(r=e.y),(null===t||e.x>t)&&(t=e.x),(null===o||e.y>o)&&(o=e.y)});var a=-n-.5*(t-n),s=-r-.5*(o-r);return e.map(function(e){return new i.q(e.x+a,e.y+s)})}(n)},U={depth:1,bevelEnabled:!1},Z=function e(){var n;Object(r.a)(this,e);var t=!1,s=new i.p([new i.q(-1200,900),new i.q(-1200,-900),new i.q(1200,-900),new i.q(1200,900)]),c=new i.j(new i.f(s,U),o);this.mesh=c,this.moveTo=function(e){c.position.set(0,0,e),c.position.z<0&&(c.material=o)},this.zoom=function(){t=!0},this.setNewHole=function(e){t=!1;var r=H(n=e),o=new i.l(r);s.holes=[o],c.geometry=new i.f(s,U)},this.checkFit=function(e){return function(e,n){if(e.length!==n.length)return!1;var t=P(e),r=P(n);return t.every(function(e,n){return e.equals(r[n])})}(e,n)},this.isAtFigure=function(){return t?c.position.z+400>=0:c.position.z+12>=0},this.isPastFigure=function(){return c.position.z>0},this.isOffCamera=function(){return c.position.z>500},this.update=function(){c.position.z>=0&&(t=!1,c.material=a,c.material.opacity=1-c.position.z/500),t?c.position.z+400>0?c.translateZ(Math.max(12,-c.position.z)):c.translateZ(400):c.translateZ(12)}},X=function e(){Object(r.a)(this,e);var n=[new Z,new Z],t=0,i=n[t],o=null,a=!1;n.forEach(function(e){e.moveTo(-1e5)}),i.moveTo(-1e4),this.getScreens=function(){return n},this.zoom=function(){i.zoom()},this.stop=function(){a=!0},this.setNextScreen=function(e){o=i,t=(t+1)%n.length,(i=n[t]).setNewHole(e),i.moveTo(-1e4)},this.setNewHole=function(e){i.setNewHole(e)},this.checkFit=function(e){return i.checkFit(e)},this.isAtFigure=function(){return i.isAtFigure()},this.isPastFigure=function(){return i.isPastFigure()},this.reset=function(){n.forEach(function(e){e.moveTo(-1e5)}),i.moveTo(-1e4),a=!1},this.update=function(){a||(i.update(),o&&(o.update(),o.isOffCamera()&&(o=null)))}},Y=function e(n){var t=this,o=n.width,a=n.height,s=n.onUpdateScore,c=n.onEndGame;Object(r.a)(this,e),this.animate=function(){t.requestId=requestAnimationFrame(t.animate),t.screenManager.isAtFigure()&&!t.screenManager.checkFit(t.figure.getCurrentProjection())&&(t.figure.turnRed(),t.screenManager.stop(),cancelAnimationFrame(t.requestId),t.requestId=null,t.onEndGame({finalScore:t.score})),t.screenManager.isPastFigure()&&(t.score+=1,t.onUpdateScore(t.score),t.figure.addBlocks(),t.updateCameraPosition(),t.screenManager.setNextScreen(t.figure.getRandomProjection())),t.figure.update(),t.camera.update(),t.screenManager.update(),t.renderer.render(t.scene,t.camera.getCamera())},this.getDomElement=function(){return t.renderer.domElement},this.isRunning=function(){return!!t.requestId},this.reset=function(){t.score=0,t.onUpdateScore(t.score),t.figure.reset(),t.screenManager.reset(),t.screenManager.setNewHole(t.figure.getRandomProjection()),t.updateCameraPosition(),t.animate()},this.updateCameraPosition=function(){t.camera.setDistance(500+.5*t.figure.maxDimension),t.camera.setOffset(90+.5*t.figure.maxDimension)},this.start=function(){t.animate()},this.resize=function(e,n){t.camera.setSize(e,n),t.renderer.setSize(e,n)},this.rotateFigure=function(e){t.figure.rotate(e)},this.toggleCamera=function(){t.camera.togglePosition()},this.zoom=function(){t.screenManager.zoom()},this.onUpdateScore=s,this.onEndGame=c,this.requestId=null,this.score=0,this.figure=new L,this.camera=new u,this.scene=new i.o,this.renderer=new i.s,this.screenManager=new X,this.onUpdateScore(0),this.camera.setSize(o,a),this.updateCameraPosition(),this.renderer.gammaInput=!0,this.renderer.gammeOutput=!0,this.renderer.setSize(o,a),this.scene.background=new i.c(9165298),this.scene.fog=new i.g(9165298,1,15e3),this.scene.add(new i.a(4210752));var l=new i.d;l.position.set(-3,5,7),this.scene.add(l),this.scene.add(this.figure.mesh),this.screenManager.setNewHole(this.figure.getRandomProjection()),this.screenManager.getScreens().forEach(function(e){t.scene.add(e.mesh)})},W=t(72),_=t.n(W),J=t(73),Q=t.n(J),V=document.getElementById("touch"),K=null,$=null,ee=null,ne=!1,te=(t(194),t(196),document.getElementById("start-screen")),re=document.getElementById("start-button"),ie=document.getElementById("end-screen"),oe=document.getElementById("final-score"),ae=document.getElementById("high-score"),se=document.getElementById("restart-button"),ce=document.getElementById("score"),ue=localStorage.getItem("high-score")||0,le=!1,fe=new Y({width:window.innerWidth,height:window.innerHeight,onUpdateScore:function(e){ce.innerText=e},onEndGame:function(e){var n=e.finalScore;n>ue&&(ue=n,localStorage.setItem("high-score",ue)),oe.innerText=n,ae.innerText=ue,ie.style.display="block",ie.className="inactive",requestAnimationFrame(function(){ie.className="active"})}}),he=function(){te.style.display="none",fe.start(),le=!0},de=function(){ie.style.display="none",fe.reset()};re.addEventListener("click",he),se.addEventListener("click",de),window.addEventListener("resize",_()(function(){fe.resize(window.innerWidth,window.innerHeight)},300)),function(e){var n=e.getGameRunning,t=e.getGamePlayed,r=e.rotateFigure,i=e.toggleCamera,o=e.zoom,a=e.startGame,s=e.restartGame;window.addEventListener("keydown",function(e){if(["ArrowDown","ArrowUp","Space","Tab"].includes(e.code)&&e.preventDefault(),n())switch(e.code){case"ArrowDown":r("down");break;case"ArrowUp":r("up");break;case"ArrowLeft":r("left");break;case"ArrowRight":r("right");break;case"BracketLeft":r("counter-clockwise");break;case"BracketRight":r("clockwise");break;case"KeyQ":case"Tab":i();break;case"Space":o()}else"Space"===e.code&&(t()?s():a())})}({rotateFigure:fe.rotateFigure,zoom:fe.zoom,toggleCamera:fe.toggleCamera,getGameRunning:fe.isRunning,getGamePlayed:function(){return le},startGame:he,restartGame:de}),("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)&&function(e){var n=e.zoom,t=e.rotateFigure;V.style.display="block",V.addEventListener("touchstart",function(e){e.preventDefault(),K={x:e.touches[0].clientX,y:e.touches[0].clientY},$={x:0,y:0},ee=(new Date).getTime(),ne=!1}),V.addEventListener("touchmove",function(e){e.preventDefault();var n={x:e.touches[0].clientX,y:e.touches[0].clientY};!ne&&function(e,n){var t=e.x-n.x,r=e.y-n.y;return Math.sqrt(t*t+r*r)}(K,n)>9&&(ne=!0);var r=Q()($);$.x=Math.round((n.x-K.x)/60),$.y=Math.round((n.y-K.y)/60),$.x>r.x?t("right"):$.x<r.x&&t("left"),$.y>r.y?t("down"):$.y<r.y&&t("up")}),V.addEventListener("touchend",function(e){e.preventDefault(),(new Date).getTime()-ee<300&&!ne&&n()})}({rotateFigure:fe.rotateFigure,zoom:fe.zoom}),document.body.appendChild(fe.getDomElement()),"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("https://blockturnal.com/service-worker.js").then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})})},74:function(e,n,t){e.exports=t(198)}},[[74,2,1]]]);
//# sourceMappingURL=main.a5ac210d.chunk.js.map